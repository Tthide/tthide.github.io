<section class="flex flex-col gap-8 lg:gap-30">

    <h2 class="text-smooth_dark text-3xl md:text-4xl lg:text-5xl font-spartan text-center">PROCESS</h2>

    <!-- Swiper Container -->
    <div class="swiper process-swiper h-[70svh] w-full bg-accent_blue/80 p-5 rounded-2xl">

        <div class="swiper-wrapper items-end">
            @for (step of processStep; track $index; let idx = $index) {
            <div class="swiper-slide flex flex-col gap-1 lg:gap-3 overflow-y-auto bg-light rounded-2xl transition p-4 xl:p-6"
                [ngClass]="{
    'w-[80%] md:w-2/3 h-[100%] z-10': step.isFocused,
    'w-1/4 h-1/4 opacity-70 items-center justify-center': !step.isFocused
  }">

                <!-- Card Header -->
                <h3 class="w-full flex justify-between items-center">
                    <span class= "max-w-full text-accent_purple font-bold " [ngClass]="{
      'md:text-lg text-xl': step.isFocused,
      'md:text-base lg:text-2xl truncate lg:whitespace-normal text-ellipsis': !step.isFocused
    }">
                        Step {{ idx + 1 }} â€“ {{ step.step_title }} </span>
                </h3>
                <!-- Card Content (Collapsible) -->
                <div class="transition-all duration-300" [class.hidden]="!step.isFocused">
                    <div class="project-content-rich-text" [innerHTML]="step.content"></div>

                    @if (step.picture) {
                    <div class="w-full">
                        <img [src]="step.picture.url" [alt]="step.picture.alt"
                            class="w-full max-h-[50vh] object-contain rounded-xl mb-2" />
                        @if(step.picture.source){
                        <p class="text-sm text-gray-500 mt-1">{{ step.picture.source }}</p>
                        }
                    </div>
                    }
                </div>

            </div>
            }
        </div>
        <!-- Navigation Buttons -->
        <div class="flex justify-between mt-6">
            <button
                class="swiper-button-prev bg-smooth_dark text-white rounded-full p-3 hover:bg-accent_purple transition"
                aria-label="Previous process step">

            </button>
            <button
                class="swiper-button-next bg-smooth_dark text-white rounded-full p-3 hover:bg-accent_purple transition"
                aria-label="Next process step">

            </button>
        </div>
        <!-- Pagination-->
        <div class="swiper-pagination mt-4"></div>
    </div>
</section>